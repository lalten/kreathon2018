#! /usr/bin/python
# coding: utf8

from requests import Request, Session
import requests
import Levenshtein
import io
import time

class HereConector:
    app_id = "nAX0YLEqe9rDAffuvS9L"
    app_code = "O_9Z4uw6cbqaUNKCrWvAlg"

    map_view_url = "https://image.maps.api.here.com/mia/1.6/mapview"
    auto_suggest_url = "https://places.cit.api.here.com/places/v1/autosuggest"
    # sequence_url = "https://wse.api.here.com/2/findsequence.json"
    sequence_url = "https://wse.cit.api.here.com/2/findsequence.json"
    calc_route_url = "https://route.api.here.com/routing/7.2/calculateroute.json"

    # route_url = "https://image.maps.api.here.com/mia/1.6/route"
    route_url = "https://image.maps.api.here.com/mia/1.6/route"


    container_locations = [(u'Agnes-Bernauer-Stra\xdfe', [48.140919, 11.48829]), (u'Agricolaplatz / Agricolastra\xdfe', [48.14143, 11.49284]), (u'Agricolastra\xdfe', [48.137711, 11.49171]), (u'Eringerstra\xdfe', [48.13158, 11.48658]), (u'Friedenheimer Stra\xdfe / Agnes Bernauer Stra\xdfe', [48.13957, 11.5113]), (u'Hans Thonauer Stra\xdfe / Kiem Pauli Weg', [48.13323, 11.51661]), (u'Hans Thonauer Stra\xdfe / N\xf6rdlinger Stra\xdfe', [48.13234, 11.51502]), (u'Hauzenberger Stra\xdfe / Elsenheimerstra\xdfe', [48.13794, 11.52145]), (u'Hogenbergplatz / Valpichlerstra\xdfe', [48.13726, 11.50687]), (u'Inderstorferstra\xdfe / Reindlstra\xdfe', [48.12896, 11.50101]), (u'Joergstra\xdfe / Aindorferstra\xdfe', [48.13107, 11.49992]), (u'Joergstra\xdfe / Inderstorferstra\xdfe', [48.12924, 11.49878]), (u'K\xe4rntner Platz', [48.126659, 11.5045]), (u'K\xe4the-Bauer-Weg', [48.12838, 11.50719]), (u'Kiem-Pauli-Weg', [48.134701, 11.51318]), (u'Landsberger Stra\xdfe / Friedenheimer Stra\xdfe', [48.1421, 11.51237]), (u'Landsberger Stra\xdfe', [48.141682, 11.51507]), (u'N\xf6rdlinger Stra\xdfe / Perkhoferstra\xdfe', [48.13111, 11.51659]), (u'Raublinger Stra\xdfe / Steinbeisplatz', [48.12853, 11.51227]), (u'Riegerhofstra\xdfe / Valpichlerstra\xdfe', [48.13776, 11.49992]), (u'Rushaimerstra\xdfe / Camerloherstra\xdfe', [48.13412, 11.4952]), (u'St\xf6berlstra\xdfe / Agricolaplatz', [48.14113, 11.49475]), (u'Straubinger Stra\xdfe / Wilhelm Riehl Stra\xdfe', [48.1357, 11.52032]), (u'Valpichlerstra\xdfe / Von der Pfordten Stra\xdfe', [48.13782, 11.49565]), (u'Veit Sto\xdf Stra\xdfe / Sandrartstra\xdfe', [48.14118, 11.50744]), (u'Viebigplatz / Droste-H\xfclshoff-Stra\xdfe', [48.12833, 11.50772]), (u'Westendstra\xdfe / Zschokkestra\xdfe', [48.1348, 11.52198]), (u'Wilhelm Riehl Stra\xdfe / Siglstra\xdfe', [48.13588, 11.51368]), (u'Willibaldstra\xdfe / Camerloherstra\xdfe', [48.13485, 11.48405]), (u'Zschokkestra\xdfe / Lautensackstra\xdfe', [48.13499, 11.51723])]
    # optimized_sequence = {"results":[{"waypoints":[{"id":"start","lat":48.140919,"lng":11.48829,"sequence":0,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination1","lat":48.14143,"lng":11.49284,"sequence":1,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination2","lat":48.137711,"lng":11.49171,"sequence":2,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination3","lat":48.13158,"lng":11.48658,"sequence":3,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination10","lat":48.13107,"lng":11.49992,"sequence":4,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination9","lat":48.12896,"lng":11.50101,"sequence":5,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination8","lat":48.13726,"lng":11.50687,"sequence":6,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination4","lat":48.13957,"lng":11.5113,"sequence":7,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination7","lat":48.13794,"lng":11.52145,"sequence":8,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination6","lat":48.13234,"lng":11.51502,"sequence":9,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"destination5","lat":48.13323,"lng":11.51661,"sequence":10,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]},{"id":"end","lat":48.13499,"lng":11.51723,"sequence":11,"estimatedArrival":null,"estimatedDeparture":null,"fulfilledConstraints":[]}],"distance":"8725","time":"2576","interconnections":[{"fromWaypoint":"start","toWaypoint":"destination1","distance":461.0,"time":137.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination1","toWaypoint":"destination2","distance":421.0,"time":187.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination2","toWaypoint":"destination3","distance":1485.0,"time":336.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination3","toWaypoint":"destination10","distance":1215.0,"time":446.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination10","toWaypoint":"destination9","distance":408.0,"time":143.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination9","toWaypoint":"destination8","distance":1396.0,"time":397.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination8","toWaypoint":"destination4","distance":613.0,"time":235.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination4","toWaypoint":"destination7","distance":948.0,"time":243.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination7","toWaypoint":"destination6","distance":1416.0,"time":310.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination6","toWaypoint":"destination5","distance":155.0,"time":47.0,"rest":0.0,"waiting":0.0},{"fromWaypoint":"destination5","toWaypoint":"end","distance":207.0,"time":95.0,"rest":0.0,"waiting":0.0}],"description":"Targeted best time; without traffic","timeBreakdown":{"driving":2576,"service":0,"rest":0,"waiting":0}}],"errors":[],"processingTimeDesc":"218ms","responseCode":"200","warnings":null,"requestId":null}


    route = {u'response': {u'route': [{u'leg': [{u'start': {u'sideOfStreet': u'neither', u'linkId': u'-52804055', u'spot': 1.0, u'label': u'Willibaldplatz', u'mappedRoadName': u'Willibaldplatz', u'shapeIndex': 0, u'originalPosition': {u'latitude': 48.140919, u'longitude': 11.48829}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1409204, u'longitude': 11.4882874}}, u'length': 461, u'end': {u'sideOfStreet': u'neither', u'linkId': u'+52803697', u'spot': 1.0, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 6, u'originalPosition': {u'latitude': 48.1414299, u'longitude': 11.49284}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1414247, u'longitude': 11.4928365}}, u'travelTime': 81, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Reutterstra\xdfe</span> on <span class="street">Willibaldplatz</span>. <span class="distance-description">Go for <span class="length">323 m</span>.</span>', u'id': u'M1', u'length': 323, u'position': {u'latitude': 48.1409204, u'longitude': 11.4882874}, u'travelTime': 43}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Agricolastra\xdfe</span>. <span class="distance-description">Go for <span class="length">138 m</span>.</span>', u'id': u'M2', u'length': 138, u'position': {u'latitude': 48.1402016, u'longitude': 11.4925146}, u'travelTime': 38}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Agricolastra\xdfe</span>.', u'id': u'M3', u'length': 0, u'position': {u'latitude': 48.1414247, u'longitude': 11.4928365}, u'travelTime': 5}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'+52803697', u'spot': 1.0, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 6, u'originalPosition': {u'latitude': 48.1414299, u'longitude': 11.49284}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1414247, u'longitude': 11.4928365}}, u'length': 707, u'end': {u'sideOfStreet': u'neither', u'linkId': u'-52807227', u'spot': 0.5405405, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 13, u'originalPosition': {u'latitude': 48.137711, u'longitude': 11.4917099}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.137711, u'longitude': 11.4917094}}, u'travelTime': 150, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Ronpeckhstra\xdfe</span> on <span class="street">Agricolaplatz</span>. <span class="distance-description">Go for <span class="length">146 m</span>.</span>', u'id': u'M4', u'length': 146, u'position': {u'latitude': 48.1414247, u'longitude': 11.4928365}, u'travelTime': 29}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">St\xf6berlstra\xdfe</span>. <span class="distance-description">Go for <span class="length">118 m</span>.</span>', u'id': u'M5', u'length': 118, u'position': {u'latitude': 48.141135, u'longitude': 11.4947462}, u'travelTime': 28}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Agnes-Bernauer-Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">150 m</span>.</span>', u'id': u'M6', u'length': 150, u'position': {u'latitude': 48.1400836, u'longitude': 11.4945424}, u'travelTime': 24}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Agricolastra\xdfe</span>. <span class="distance-description">Go for <span class="length">293 m</span>.</span>', u'id': u'M7', u'length': 293, u'position': {u'latitude': 48.1402874, u'longitude': 11.4925468}, u'travelTime': 64}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Agricolastra\xdfe</span>.', u'id': u'M8', u'length': 0, u'position': {u'latitude': 48.137711, u'longitude': 11.4917094}, u'travelTime': 0}]}], u'summary': {u'distance': 1168, u'_type': u'RouteSummaryType', u'baseTime': 231, u'text': u'The trip takes <span class="length">1.2 km</span> and <span class="time">4 mins</span>.', u'flags': [u'builtUpArea'], u'trafficTime': 231, u'travelTime': 231}, u'waypoint': [{u'sideOfStreet': u'neither', u'linkId': u'-52804055', u'spot': 1.0, u'label': u'Willibaldplatz', u'mappedRoadName': u'Willibaldplatz', u'shapeIndex': 0, u'originalPosition': {u'latitude': 48.140919, u'longitude': 11.48829}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1409204, u'longitude': 11.4882874}}, {u'sideOfStreet': u'neither', u'linkId': u'+52803697', u'spot': 1.0, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 6, u'originalPosition': {u'latitude': 48.1414299, u'longitude': 11.49284}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1414247, u'longitude': 11.4928365}}, {u'sideOfStreet': u'neither', u'linkId': u'-52807227', u'spot': 0.5405405, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 13, u'originalPosition': {u'latitude': 48.137711, u'longitude': 11.4917099}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.137711, u'longitude': 11.4917094}}], u'mode': {u'trafficMode': u'disabled', u'type': u'fastest', u'feature': [], u'transportModes': [u'car']}}], u'language': u'en-us', u'metaInfo': {u'timestamp': u'2018-10-31T19:17:30Z', u'availableMapVersion': [u'8.30.90.150'], u'interfaceVersion': u'2.6.34', u'mapVersion': u'8.30.90.150', u'moduleVersion': u'7.2.201842-40'}}}
    # route = {'waypoint5': '48.13323,11.51661', 'waypoint8': '48.13726,11.50687', 'waypoint9': '48.12896,11.50101', 'waypoint6': '48.13234,11.51502', 'waypoint7': '48.13794,11.52145', 'waypoint3': '48.13158,11.48658', 'app_code': 'O_9Z4uw6cbqaUNKCrWvAlg', 'waypoint2': '48.137711,11.49171', 'app_id': 'nAX0YLEqe9rDAffuvS9L', 'waypoint0': '48.140919,11.48829', 'waypoint1': '48.14143,11.49284', 'waypoint10': '48.13107,11.49992', 'mode': 'fastest;car;traffic:disabled', 'waypoint4': '48.13957,11.5113'}
    route = {u'response': {u'route': [{u'leg': [{u'start': {u'sideOfStreet': u'neither', u'linkId': u'-52804055', u'spot': 1.0, u'label': u'Willibaldplatz', u'mappedRoadName': u'Willibaldplatz', u'shapeIndex': 0, u'originalPosition': {u'latitude': 48.140919, u'longitude': 11.48829}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1409204, u'longitude': 11.4882874}}, u'length': 461, u'end': {u'sideOfStreet': u'neither', u'linkId': u'+52803697', u'spot': 1.0, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 6, u'originalPosition': {u'latitude': 48.1414299, u'longitude': 11.49284}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1414247, u'longitude': 11.4928365}}, u'travelTime': 81, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Reutterstra\xdfe</span> on <span class="street">Willibaldplatz</span>. <span class="distance-description">Go for <span class="length">323 m</span>.</span>', u'id': u'M1', u'length': 323, u'position': {u'latitude': 48.1409204, u'longitude': 11.4882874}, u'travelTime': 43}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Agricolastra\xdfe</span>. <span class="distance-description">Go for <span class="length">138 m</span>.</span>', u'id': u'M2', u'length': 138, u'position': {u'latitude': 48.1402016, u'longitude': 11.4925146}, u'travelTime': 38}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Agricolastra\xdfe</span>.', u'id': u'M3', u'length': 0, u'position': {u'latitude': 48.1414247, u'longitude': 11.4928365}, u'travelTime': 5}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'+52803697', u'spot': 1.0, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 6, u'originalPosition': {u'latitude': 48.1414299, u'longitude': 11.49284}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1414247, u'longitude': 11.4928365}}, u'length': 707, u'end': {u'sideOfStreet': u'neither', u'linkId': u'-52807227', u'spot': 0.5405405, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 13, u'originalPosition': {u'latitude': 48.137711, u'longitude': 11.4917099}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.137711, u'longitude': 11.4917094}}, u'travelTime': 150, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Ronpeckhstra\xdfe</span> on <span class="street">Agricolaplatz</span>. <span class="distance-description">Go for <span class="length">146 m</span>.</span>', u'id': u'M4', u'length': 146, u'position': {u'latitude': 48.1414247, u'longitude': 11.4928365}, u'travelTime': 29}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">St\xf6berlstra\xdfe</span>. <span class="distance-description">Go for <span class="length">118 m</span>.</span>', u'id': u'M5', u'length': 118, u'position': {u'latitude': 48.141135, u'longitude': 11.4947462}, u'travelTime': 28}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Agnes-Bernauer-Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">150 m</span>.</span>', u'id': u'M6', u'length': 150, u'position': {u'latitude': 48.1400836, u'longitude': 11.4945424}, u'travelTime': 24}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Agricolastra\xdfe</span>. <span class="distance-description">Go for <span class="length">293 m</span>.</span>', u'id': u'M7', u'length': 293, u'position': {u'latitude': 48.1402874, u'longitude': 11.4925468}, u'travelTime': 64}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Agricolastra\xdfe</span>.', u'id': u'M8', u'length': 0, u'position': {u'latitude': 48.137711, u'longitude': 11.4917094}, u'travelTime': 0}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'-52807227', u'spot': 0.5405405, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 13, u'originalPosition': {u'latitude': 48.137711, u'longitude': 11.4917099}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.137711, u'longitude': 11.4917094}}, u'length': 945, u'end': {u'sideOfStreet': u'neither', u'linkId': u'-52807522', u'spot': 0.0, u'label': u'Junkerstra\xdfe', u'mappedRoadName': u'Junkerstra\xdfe', u'shapeIndex': 25, u'originalPosition': {u'latitude': 48.1315799, u'longitude': 11.48658}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1315756, u'longitude': 11.4865816}}, u'travelTime': 199, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Johannes-Scharrer-Stra\xdfe</span> on <span class="street">Agricolastra\xdfe</span>. <span class="distance-description">Go for <span class="length">159 m</span>.</span>', u'id': u'M9', u'length': 159, u'position': {u'latitude': 48.137711, u'longitude': 11.4917094}, u'travelTime': 49}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Continue on <span class="next-street">Agricolastra\xdfe</span>. <span class="distance-description">Go for <span class="length">441 m</span>.</span>', u'id': u'M10', u'length': 441, u'position': {u'latitude': 48.1363177, u'longitude': 11.4912057}, u'travelTime': 82}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Rechpacherstra\xdfe</span>. <span class="distance-description">Go for <span class="length">230 m</span>.</span>', u'id': u'M11', u'length': 230, u'position': {u'latitude': 48.1324875, u'longitude': 11.4897573}, u'travelTime': 50}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Junkerstra\xdfe</span>. <span class="distance-description">Go for <span class="length">115 m</span>.</span>', u'id': u'M12', u'length': 115, u'position': {u'latitude': 48.1326056, u'longitude': 11.4866781}, u'travelTime': 18}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Junkerstra\xdfe</span>.', u'id': u'M13', u'length': 0, u'position': {u'latitude': 48.1315756, u'longitude': 11.4865816}, u'travelTime': 5}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'-52807522', u'spot': 0.0, u'label': u'Junkerstra\xdfe', u'mappedRoadName': u'Junkerstra\xdfe', u'shapeIndex': 25, u'originalPosition': {u'latitude': 48.1315799, u'longitude': 11.48658}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1315756, u'longitude': 11.4865816}}, u'length': 3134, u'end': {u'sideOfStreet': u'neither', u'linkId': u'+52804210', u'spot': 1.0, u'label': u'Friedenheimer Stra\xdfe', u'mappedRoadName': u'Friedenheimer Stra\xdfe', u'shapeIndex': 60, u'originalPosition': {u'latitude': 48.13957, u'longitude': 11.5113}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1395686, u'longitude': 11.5113008}}, u'travelTime': 445, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head <span class="heading">north</span> on <span class="street">Eringerstra\xdfe</span>. <span class="distance-description">Go for <span class="length">283 m</span>.</span>', u'id': u'M14', u'length': 283, u'position': {u'latitude': 48.1315756, u'longitude': 11.4865816}, u'travelTime': 61}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Willibaldstra\xdfe</span>. <span class="distance-description">Go for <span class="length">1.1 km</span>.</span>', u'id': u'M15', u'length': 1105, u'position': {u'latitude': 48.131758, u'longitude': 11.4827836}, u'travelTime': 147}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Willibaldplatz</span>. <span class="distance-description">Go for <span class="length">1.7 km</span>.</span>', u'id': u'M16', u'length': 1710, u'position': {u'latitude': 48.1409204, u'longitude': 11.4882874}, u'travelTime': 210}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Friedenheimer Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">36 m</span>.</span>', u'id': u'M17', u'length': 36, u'position': {u'latitude': 48.1392896, u'longitude': 11.5110648}, u'travelTime': 22}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Friedenheimer Stra\xdfe</span>.', u'id': u'M18', u'length': 0, u'position': {u'latitude': 48.1395686, u'longitude': 11.5113008}, u'travelTime': 0}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'+52804210', u'spot': 1.0, u'label': u'Friedenheimer Stra\xdfe', u'mappedRoadName': u'Friedenheimer Stra\xdfe', u'shapeIndex': 60, u'originalPosition': {u'latitude': 48.13957, u'longitude': 11.5113}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1395686, u'longitude': 11.5113008}}, u'length': 1149, u'end': {u'sideOfStreet': u'neither', u'linkId': u'-812946873', u'spot': 0.0, u'label': u'Hans-Thonauer-Stra\xdfe', u'mappedRoadName': u'Hans-Thonauer-Stra\xdfe', u'shapeIndex': 78, u'originalPosition': {u'latitude': 48.1332299, u'longitude': 11.51661}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1332278, u'longitude': 11.5166116}}, u'travelTime': 231, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Agnes-Bernauer-Stra\xdfe</span> on <span class="street">Friedenheimer Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">22 m</span>.</span>', u'id': u'M19', u'length': 22, u'position': {u'latitude': 48.1395686, u'longitude': 11.5113008}, u'travelTime': 22}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Agnes-Bernauer-Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">213 m</span>.</span>', u'id': u'M20', u'length': 213, u'position': {u'latitude': 48.1393969, u'longitude': 11.5111506}, u'travelTime': 48}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Siglstra\xdfe</span>. <span class="distance-description">Go for <span class="length">428 m</span>.</span>', u'id': u'M21', u'length': 428, u'position': {u'latitude': 48.1389785, u'longitude': 11.5136826}, u'travelTime': 71}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Zschokkestra\xdfe</span>. <span class="distance-description">Go for <span class="length">288 m</span>.</span>', u'id': u'M22', u'length': 288, u'position': {u'latitude': 48.1351161, u'longitude': 11.5134895}, u'travelTime': 57}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Hans-Thonauer-Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">198 m</span>.</span>', u'id': u'M23', u'length': 198, u'position': {u'latitude': 48.1349123, u'longitude': 11.5172017}, u'travelTime': 33}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Hans-Thonauer-Stra\xdfe</span>.', u'id': u'M24', u'length': 0, u'position': {u'latitude': 48.1332278, u'longitude': 11.5166116}, u'travelTime': 0}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'-812946873', u'spot': 0.0, u'label': u'Hans-Thonauer-Stra\xdfe', u'mappedRoadName': u'Hans-Thonauer-Stra\xdfe', u'shapeIndex': 78, u'originalPosition': {u'latitude': 48.1332299, u'longitude': 11.51661}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1332278, u'longitude': 11.5166116}}, u'length': 155, u'end': {u'sideOfStreet': u'neither', u'linkId': u'-52808115', u'spot': 0.0, u'label': u'Hans-Thonauer-Stra\xdfe', u'mappedRoadName': u'Hans-Thonauer-Stra\xdfe', u'shapeIndex': 80, u'originalPosition': {u'latitude': 48.1323399, u'longitude': 11.5150199}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1323373, u'longitude': 11.5150237}}, u'travelTime': 26, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Barmer Stra\xdfe</span> on <span class="street">Hans-Thonauer-Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">155 m</span>.</span>', u'id': u'M25', u'length': 155, u'position': {u'latitude': 48.1332278, u'longitude': 11.5166116}, u'travelTime': 26}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Hans-Thonauer-Stra\xdfe</span>.', u'id': u'M26', u'length': 0, u'position': {u'latitude': 48.1323373, u'longitude': 11.5150237}, u'travelTime': 0}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'-52808115', u'spot': 0.0, u'label': u'Hans-Thonauer-Stra\xdfe', u'mappedRoadName': u'Hans-Thonauer-Stra\xdfe', u'shapeIndex': 80, u'originalPosition': {u'latitude': 48.1323399, u'longitude': 11.5150199}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1323373, u'longitude': 11.5150237}}, u'length': 1339, u'end': {u'sideOfStreet': u'neither', u'linkId': u'+1207604343', u'spot': 1.0, u'label': u'Elsenheimerstra\xdfe', u'mappedRoadName': u'Elsenheimerstra\xdfe', u'shapeIndex': 96, u'originalPosition': {u'latitude': 48.13794, u'longitude': 11.5214499}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1379378, u'longitude': 11.5214503}}, u'travelTime': 209, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Barmer Stra\xdfe</span> on <span class="street">Hans-Thonauer-Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">353 m</span>.</span>', u'id': u'M27', u'length': 353, u'position': {u'latitude': 48.1323373, u'longitude': 11.5150237}, u'travelTime': 69}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Zschokkestra\xdfe</span>. <span class="distance-description">Go for <span class="length">416 m</span>.</span>', u'id': u'M28', u'length': 416, u'position': {u'latitude': 48.1349123, u'longitude': 11.5172017}, u'travelTime': 40}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Westendstra\xdfe</span>. <span class="distance-description">Go for <span class="length">223 m</span>.</span>', u'id': u'M29', u'length': 223, u'position': {u'latitude': 48.1343758, u'longitude': 11.5225983}, u'travelTime': 62}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Elsenheimerstra\xdfe</span>. <span class="distance-description">Go for <span class="length">347 m</span>.</span>', u'id': u'M30', u'length': 347, u'position': {u'latitude': 48.1356311, u'longitude': 11.5246046}, u'travelTime': 38}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Elsenheimerstra\xdfe</span>.', u'id': u'M31', u'length': 0, u'position': {u'latitude': 48.1379378, u'longitude': 11.5214503}, u'travelTime': 0}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'+1207604343', u'spot': 1.0, u'label': u'Elsenheimerstra\xdfe', u'mappedRoadName': u'Elsenheimerstra\xdfe', u'shapeIndex': 96, u'originalPosition': {u'latitude': 48.13794, u'longitude': 11.5214499}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1379378, u'longitude': 11.5214503}}, u'length': 1528, u'end': {u'sideOfStreet': u'neither', u'linkId': u'-52807464', u'spot': 0.0, u'label': u'Fr\xf6belplatz', u'mappedRoadName': u'Fr\xf6belplatz', u'shapeIndex': 118, u'originalPosition': {u'latitude': 48.1372599, u'longitude': 11.50687}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1372619, u'longitude': 11.5068698}}, u'travelTime': 230, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Ludwig-Richter-Stra\xdfe</span> on <span class="street">Elsenheimerstra\xdfe</span>. <span class="distance-description">Go for <span class="length">321 m</span>.</span>', u'id': u'M32', u'length': 321, u'position': {u'latitude': 48.1379378, u'longitude': 11.5214503}, u'travelTime': 36}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Lautensackstra\xdfe</span>. <span class="distance-description">Go for <span class="length">127 m</span>.</span>', u'id': u'M33', u'length': 127, u'position': {u'latitude': 48.1400192, u'longitude': 11.5184784}, u'travelTime': 31}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Agnes-Bernauer-Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">805 m</span>.</span>', u'id': u'M34', u'length': 805, u'position': {u'latitude': 48.1391072, u'longitude': 11.5178454}, u'travelTime': 100}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">Fr\xf6belplatz</span>. <span class="distance-description">Go for <span class="length">275 m</span>.</span>', u'id': u'M35', u'length': 275, u'position': {u'latitude': 48.1397295, u'longitude': 11.5070951}, u'travelTime': 63}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Fr\xf6belplatz</span>.', u'id': u'M36', u'length': 0, u'position': {u'latitude': 48.1372619, u'longitude': 11.5068698}, u'travelTime': 2}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'-52807464', u'spot': 0.0, u'label': u'Fr\xf6belplatz', u'mappedRoadName': u'Fr\xf6belplatz', u'shapeIndex': 118, u'originalPosition': {u'latitude': 48.1372599, u'longitude': 11.50687}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1372619, u'longitude': 11.5068698}}, u'length': 1335, u'end': {u'sideOfStreet': u'neither', u'linkId': u'+52807507', u'spot': 1.0, u'label': u'Inderstorferstra\xdfe', u'mappedRoadName': u'Inderstorferstra\xdfe', u'shapeIndex': 128, u'originalPosition': {u'latitude': 48.1289599, u'longitude': 11.5010099}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1289577, u'longitude': 11.5010118}}, u'travelTime': 212, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">Hogenbergstra\xdfe</span> on <span class="street">Hogenbergplatz</span>. <span class="distance-description">Go for <span class="length">109 m</span>.</span>', u'id': u'M37', u'length': 109, u'position': {u'latitude': 48.1372619, u'longitude': 11.5068698}, u'travelTime': 20}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Continue on <span class="next-street">Ostendorferweg</span>. <span class="distance-description">Go for <span class="length">100 m</span>.</span>', u'id': u'M38', u'length': 100, u'position': {u'latitude': 48.1362748, u'longitude': 11.506741}, u'travelTime': 25}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Gotthardstra\xdfe</span>. <span class="distance-description">Go for <span class="length">269 m</span>.</span>', u'id': u'M39', u'length': 269, u'position': {u'latitude': 48.1353843, u'longitude': 11.5066552}, u'travelTime': 51}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">left</span> onto <span class="next-street">F\xfcrstenrieder Stra\xdfe</span>. <span class="distance-description">Go for <span class="length">732 m</span>.</span>', u'id': u'M40', u'length': 732, u'position': {u'latitude': 48.1353951, u'longitude': 11.5030503}, u'travelTime': 91}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Inderstorferstra\xdfe</span>. <span class="distance-description">Go for <span class="length">125 m</span>.</span>', u'id': u'M41', u'length': 125, u'position': {u'latitude': 48.1289256, u'longitude': 11.502707}, u'travelTime': 23}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Inderstorferstra\xdfe</span>.', u'id': u'M42', u'length': 0, u'position': {u'latitude': 48.1289577, u'longitude': 11.5010118}, u'travelTime': 2}]}, {u'start': {u'sideOfStreet': u'neither', u'linkId': u'+52807507', u'spot': 1.0, u'label': u'Inderstorferstra\xdfe', u'mappedRoadName': u'Inderstorferstra\xdfe', u'shapeIndex': 128, u'originalPosition': {u'latitude': 48.1289599, u'longitude': 11.5010099}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1289577, u'longitude': 11.5010118}}, u'length': 400, u'end': {u'sideOfStreet': u'right', u'linkId': u'+52807531', u'spot': 0.8035714, u'label': u'Joergstra\xdfe', u'mappedRoadName': u'Joergstra\xdfe', u'shapeIndex': 136, u'originalPosition': {u'latitude': 48.13107, u'longitude': 11.4999199}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1310928, u'longitude': 11.4997566}}, u'travelTime': 77, u'maneuver': [{u'_type': u'PrivateTransportManeuverType', u'instruction': u'Head toward <span class="toward_street">St\xfcrzerstra\xdfe</span> on <span class="street">Inderstorferstra\xdfe</span>. <span class="distance-description">Go for <span class="length">170 m</span>.</span>', u'id': u'M43', u'length': 170, u'position': {u'latitude': 48.1289577, u'longitude': 11.5010118}, u'travelTime': 35}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Turn <span class="direction">right</span> onto <span class="next-street">Joergstra\xdfe</span>. <span class="distance-description">Go for <span class="length">218 m</span>.</span>', u'id': u'M44', u'length': 218, u'position': {u'latitude': 48.1292367, u'longitude': 11.4987803}, u'travelTime': 38}, {u'_type': u'PrivateTransportManeuverType', u'instruction': u'Arrive at <span class="street">Joergstra\xdfe</span>. Your destination is on the right.', u'id': u'M45', u'length': 12, u'position': {u'latitude': 48.1310928, u'longitude': 11.4997566}, u'travelTime': 2}]}], u'summary': {u'distance': 11153, u'_type': u'RouteSummaryType', u'baseTime': 1860, u'text': u'The trip takes <span class="length">11.2 km</span> and <span class="time">31 mins</span>.', u'flags': [u'builtUpArea'], u'trafficTime': 1894, u'travelTime': 1860}, u'waypoint': [{u'sideOfStreet': u'neither', u'linkId': u'-52804055', u'spot': 1.0, u'label': u'Willibaldplatz', u'mappedRoadName': u'Willibaldplatz', u'shapeIndex': 0, u'originalPosition': {u'latitude': 48.140919, u'longitude': 11.48829}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1409204, u'longitude': 11.4882874}}, {u'sideOfStreet': u'neither', u'linkId': u'+52803697', u'spot': 1.0, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 6, u'originalPosition': {u'latitude': 48.1414299, u'longitude': 11.49284}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1414247, u'longitude': 11.4928365}}, {u'sideOfStreet': u'neither', u'linkId': u'-52807227', u'spot': 0.5405405, u'label': u'Agricolastra\xdfe', u'mappedRoadName': u'Agricolastra\xdfe', u'shapeIndex': 13, u'originalPosition': {u'latitude': 48.137711, u'longitude': 11.4917099}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.137711, u'longitude': 11.4917094}}, {u'sideOfStreet': u'neither', u'linkId': u'-52807522', u'spot': 0.0, u'label': u'Junkerstra\xdfe', u'mappedRoadName': u'Junkerstra\xdfe', u'shapeIndex': 25, u'originalPosition': {u'latitude': 48.1315799, u'longitude': 11.48658}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1315756, u'longitude': 11.4865816}}, {u'sideOfStreet': u'neither', u'linkId': u'+52804210', u'spot': 1.0, u'label': u'Friedenheimer Stra\xdfe', u'mappedRoadName': u'Friedenheimer Stra\xdfe', u'shapeIndex': 60, u'originalPosition': {u'latitude': 48.13957, u'longitude': 11.5113}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1395686, u'longitude': 11.5113008}}, {u'sideOfStreet': u'neither', u'linkId': u'-812946873', u'spot': 0.0, u'label': u'Hans-Thonauer-Stra\xdfe', u'mappedRoadName': u'Hans-Thonauer-Stra\xdfe', u'shapeIndex': 78, u'originalPosition': {u'latitude': 48.1332299, u'longitude': 11.51661}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1332278, u'longitude': 11.5166116}}, {u'sideOfStreet': u'neither', u'linkId': u'-52808115', u'spot': 0.0, u'label': u'Hans-Thonauer-Stra\xdfe', u'mappedRoadName': u'Hans-Thonauer-Stra\xdfe', u'shapeIndex': 80, u'originalPosition': {u'latitude': 48.1323399, u'longitude': 11.5150199}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1323373, u'longitude': 11.5150237}}, {u'sideOfStreet': u'neither', u'linkId': u'+1207604343', u'spot': 1.0, u'label': u'Elsenheimerstra\xdfe', u'mappedRoadName': u'Elsenheimerstra\xdfe', u'shapeIndex': 96, u'originalPosition': {u'latitude': 48.13794, u'longitude': 11.5214499}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1379378, u'longitude': 11.5214503}}, {u'sideOfStreet': u'neither', u'linkId': u'-52807464', u'spot': 0.0, u'label': u'Fr\xf6belplatz', u'mappedRoadName': u'Fr\xf6belplatz', u'shapeIndex': 118, u'originalPosition': {u'latitude': 48.1372599, u'longitude': 11.50687}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1372619, u'longitude': 11.5068698}}, {u'sideOfStreet': u'neither', u'linkId': u'+52807507', u'spot': 1.0, u'label': u'Inderstorferstra\xdfe', u'mappedRoadName': u'Inderstorferstra\xdfe', u'shapeIndex': 128, u'originalPosition': {u'latitude': 48.1289599, u'longitude': 11.5010099}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1289577, u'longitude': 11.5010118}}, {u'sideOfStreet': u'right', u'linkId': u'+52807531', u'spot': 0.8035714, u'label': u'Joergstra\xdfe', u'mappedRoadName': u'Joergstra\xdfe', u'shapeIndex': 136, u'originalPosition': {u'latitude': 48.13107, u'longitude': 11.4999199}, u'type': u'stopOver', u'mappedPosition': {u'latitude': 48.1310928, u'longitude': 11.4997566}}], u'mode': {u'trafficMode': u'disabled', u'type': u'fastest', u'feature': [], u'transportModes': [u'car']}}], u'language': u'en-us', u'metaInfo': {u'timestamp': u'2018-10-31T19:53:30Z', u'availableMapVersion': [u'8.30.90.150'], u'interfaceVersion': u'2.6.34', u'mapVersion': u'8.30.90.150', u'moduleVersion': u'7.2.201842-40'}}}

    def __init__(self):
        pass
        # print self.container_locations

    def all_auto(self):
        with io.open("inseln.txt", "r", encoding="utf-8") as my_file:
            lines = my_file.read().split('\n')

        locations = list()

        for l in lines:
            s = l.rstrip()
            if len(s) == 0:
                continue
            print ("#############################################################")
            best_hit = self.auto_suggest(query=s)
            if not best_hit:
                print ("Could not process ", s)
                continue

            locations.append((best_hit['title'], best_hit['position']))

        print (locations)

    def auto_suggest(self, query):
        app_data = {"app_id": self.app_id, "app_code": self.app_code}
        app_data['at'] = "48.1347,11.5126" # Laim
        app_data['q'] = query

        r = requests.get(self.auto_suggest_url, app_data)
        if r.status_code != 200:
            print ("ERROR: ", r.status_code)
            return None

        results = r.json()['results']
        if not results:
            return None

        best_result = None
        best_score = -1
        for r in results:
            title = r['title']
            str_score = Levenshtein.ratio(query, title)
            if str_score > best_score:
                best_result = r
                best_score = str_score

        # print str_score
        # print best_result['position']
        return best_result

    def all_images(self):
        for c in self.container_locations:
            name = c[0].replace(' ', '_').replace('/', '_')

            f_path = '/tmp/' + name + '.jpg'
            print (f_path)

            self.get_map_view(c[1], f_path)

            # break

    def loc_to_waypoint(self, location):
        return str(location[1][0]) + ',' + str(location[1][1])

    def calc_route(self):
        app_data = {"app_id": self.app_id, "app_code": self.app_code}
        app_data['mode'] = 'fastest;car;traffic:disabled'
        for i, cl in enumerate(self.container_locations):
            app_data['waypoint' + str(i)] = self.loc_to_waypoint(cl)
            if i == 10:
                break

        print (app_data)
        r = requests.get(self.calc_route_url, app_data)
        # print r.status_code
        # print r.json()

        route = r.json()
        return route

    def find_sequence(self):
        app_data = {"app_id": self.app_id, "app_code": self.app_code}
        app_data['start'] = self.loc_to_waypoint(self.container_locations[0])
        for i, cl in enumerate(self.container_locations):
            if i == 0:
                continue
            app_data['destination' + str(i)] = self.loc_to_waypoint(cl)
            if i == 10:
                break

        app_data['end'] = self.loc_to_waypoint(self.container_locations[-1])
        app_data['mode'] = 'truck;fastest'
        # print app_data

        # print time.time()
        s = Session()
        req = Request('GET', url=self.sequence_url, params=app_data).prepare()
        print (req.url)

        r = s.send(req)

        # r = requests.get(self.sequence_url, app_data)

        # print time.time()
        # print r.url
        # print r.status_code
        print (r.json())

    def route_to_image(self):
        legs = self.route['response']['route'][0]['leg']
        # print len(legs)
        way_points = list()
        for leg in legs:
            for l in leg['maneuver']:
                way_points.append("%f,%f" % (l['position']['latitude'], l['position']['longitude']))

        way_point_str = ",".join(way_points)
        # print way_point_str

        app_data = {"app_id": self.app_id, "app_code": self.app_code}
        app_data['h'] = 1024
        app_data['w'] = 1024
        app_data['ppi'] = 320
        app_data['t'] = 3
        app_data['z'] = 17  # zoom level: 20: Haus, 6: Europa

        app_data['r'] = way_point_str
        app_data['m'] = way_point_str
        app_data['lc'] = '440000ff'
        app_data['sc'] = '440000ff'
        app_data['mlbl'] = 0

        # app_data['ctr'] = way_points[0]

        app_data['lw'] = 20 # line width

        r = requests.get(self.route_url, app_data)
        print (r.url)

        # print r.content

        # print r.status_code
        f = open('/tmp/route.jpg', 'wb')
        f.write(r.content)
        f.close()

    def get_map_view(self, long_lat, file_path):
        app_data = {"app_id": self.app_id, "app_code": self.app_code}
        app_data['h'] = 512
        app_data['w'] = 512
        app_data['ppi'] = 320
        app_data['t'] = 3
        # app_data['t'] = 3  # Satellite map view with streets in day light mode.
        app_data['z'] = 16  # zoom level: 20: Haus, 6: Europa

        # app_data['ci'] = "Munich"

        app_data['lat'] = long_lat[0]
        app_data['lon'] = long_lat[1]

        # app_data['s'] = "Friedenheimer Straße" #  / Agnes-Bernauer-Straße"
        # app_data['s'] = 'Agnes-Bernauer-Straße'
        #app_data['n'] = '234'
        #app_data['zi'] = 80687  # PLZ definiert Ausschnitt

        r2 = requests.get(self.map_view_url, app_data)
        # print r2.content

        f = open(file_path, 'wb')
        f.write(r2.content)
        f.close()

if __name__ == "__main__":
    hc = HereConector()
    # hc.get_map_view('/tmp/asd.jpg')
    # hc.auto_suggest("Hauzenberger Straße/ Elsenheimerstraße")
    # hc.all_auto()
    # hc.all_images()
    hc.find_sequence()
    # print hc.calc_route()
    # hc.route_to_image()